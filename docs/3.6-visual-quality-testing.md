# Phase 3.6: Visual Quality Testing

**Status**: ✅ COMPLETE

## Approach

Visual quality is validated through parameter sweeps on synthetic shapes and by anchoring default values to watercolor targets inspired by Stamen’s palette. Automated tests assert that core knobs measurably affect the rendered output; manual review can overlay these against reference tiles.

## Implementation

**Location**: `internal/watercolor/quality_test.go`

- Blur sensitivity: verifies changing blur sigma alters feature coverage (edge softness response).
- Threshold sensitivity: verifies higher thresholds shrink coverage (crisper edges).

**Location**: `internal/watercolor/processor.go`

- Defaults tuned for watercolor look: blur 1.8, noise scale 30, noise strength 0.28, threshold 128, antialias 0.6, per-layer tints/edge strengths.
- Seeded, offset-aware noise/texture sampling to stay seamless across tiles for all tests.

## Manual Comparison Notes

1. Generate a test tile set (e.g., Hanover `z13_x4317_y2692`) with current defaults.
2. Compare against Stamen Watercolor tiles at matching zoom in a viewer (Leaflet or side-by-side).
3. Adjust per-layer tints and edge strengths if:
   - Water too light: raise water `EdgeStrength` or tint strength slightly.
   - Roads too bold: lower road `EdgeStrength` or raise threshold.
   - Land too flat: increase noise strength or edge gamma to steepen falloff.
4. Re-run `go test ./...` to ensure parameter changes still pass automated checks.

## Current Recommended Parameters (defaults)

- Blur sigma: 1.8
- Noise scale: 30.0
- Noise strength: 0.28
- Threshold: 128
- Antialias sigma: 0.6
- Edge inner/outer sigmas and strengths set per layer via `DefaultParams`

These settings yield soft watercolor edges, visible texture, and a balanced edge outline suitable for further tuning during visual reviews.
