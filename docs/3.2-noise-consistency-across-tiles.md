# Phase 3.2: Noise Consistency Across Tiles

**Status**: âœ… COMPLETE

## Strategy

- Use a single global Perlin noise field sampled via pixel offsets, so every tile taps into the same continuous noise space.
- Anchor sampling offsets to tile position (e.g., offsetX = tileX _ tileSize, offsetY = tileY _ tileSize).
- Deterministic seeds ensure reproducible noise across runs and zooms.

## Implementation

**Location**: `internal/mask/processor.go`

- Added `GeneratePerlinNoiseWithOffset(width, height, scale, seed, offsetX, offsetY)` to sample noise with global offsets.
- Legacy `GeneratePerlinNoise` now delegates to the offset-aware generator with zero offsets.
- Noise sampling uses absolute coordinates `(offset + pixel) / scale`, preventing seams between neighboring tiles.

## Tests

**Location**: `internal/mask/processor_test.go`

- `TestGeneratePerlinNoiseWithOffsetAlignment`: Verifies two horizontal tiles match a shared reference noise field.
- `TestGeneratePerlinNoiseWithOffsetVerticalAlignment`: Verifies vertical alignment the same way.

## Usage

When generating noise for a tile of size `tileSize`:

```go
noise := GeneratePerlinNoiseWithOffset(
    tileSize,
    tileSize,
    40.0,     // scale
    seed,     // deterministic seed
    int(tileX)*tileSize,
    int(tileY)*tileSize,
)
```

Sampling with offsets keeps the noise continuous at tile edges, eliminating visible seams.
